{% extends "base.html" %}
{% load wagtailcore_tags wagtailimages_tags %}
{% load wagtailvideos_tags %}
{% load static wagtailcore_tags %}

{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/home_page.css' %}">
{% endblock %}

{% block body_class %}template-homepage{% endblock %}

{% block content %}

<section id='hero'>
  {% if page.hero_text %}
    <div id="hero_text">
      <h1>{{ page.hero_text }}</h1>
    </div>
  {% endif %}
  {% if page.hero_link %}
  <div id="hero_button">
      <a href="{% pageurl page.hero_link %}">
          {% if page.hero_button %}
              {{ page.hero_button|lower }}
          {% else %}
              перейти
          {% endif %} 
      </a>
  </div>
  {% endif %}
</section>
<section id='content'>
  {{ page.body|richtext }}
</section>
<section class="section">
{% comment %} Слайдер {% endcomment %}
{% if eventpages.count > 0 %}

<style>
  [slider], [slide] {
    max-width: 1304px;
    wwidth: 95vw;
    aspect-ratio: 2.7/1;    
  }
  [slider] {
    scroll-snap-type: x mandatory;
    display: flex;
    -webkit-overflow-scrolling: touch;
    overflow-x: scroll;
    @media (hover: hover) and (pointer: fine) {
      overflow-x: hidden;
    };
    margin: 0 auto;
    border-radius: 1em;
    box-shadow: 0 0 6px white, 0 0 2px black;
    position: relative;
  }
  [slide] {
    display: block; 
    scroll-snap-align: start;
    position: relative;
    font-family: Arial, Helvetica, sans-serif;
  }
  [slide] > * {
    position: absolute;
    color: var(--body-color);
  }
  [slide] > img {
    width: 100%;
    height: 100%;
  }
  [slide] > h2, time {
    left: 1rem;
  }
  [slide] > h2 {
    bottom: 1.8rem;
    font-size: 1.2em;
    font-family: inherit;
  }
  [slide] > time, [slide] > div {
    background-color: var(--body-color);
    border-radius: 1em;
    color: var(--body-bgcolor);
    padding: .5em 1em;
    font-size: .7em;
  }
  [slide] > time {
    bottom: 1rem;
  }
  [slide] > div {
    bottom: 1rem;
    right: 1rem;
  }
</style>
<div slider>
  <button class="button-prev"> </button>
  <button class="button-next"> </button>
  {% for event in eventpages %}
     <a slide role="group" aria-labelledby="item-{{ forloop.counter }}-label"
      id="carousel-item-{{ forloop.counter }}" href="{% pageurl event %}">
      {% with event.image as image %}
        {% if image %} {% image image fill-1304x483 %} {% endif %}
      {% endwith %}
      <h2 id="item-{{ forloop.counter }}-label">{{ event.h1 }}</h2>
      <time>
        {{ event.date_on|date:"d.m.Y" }}
        {% comment %}
          TODO: Проверку дат ниже надо реализовать на стороне сервера при сохранении записи события
        {% endcomment %}
        {% if event.date_end > event.date_on %} - {{ event.date_end|date:"d.m.Y" }} {% endif %}
      </time>
      {% if event.location %} <div>{{ event.location }}</div> {% endif %}
    </a>
     {% endfor %}
</div>  

{% endif %}

</section>
{% if self.hero_video %}
  {% video self.hero_video muted loop playsinline autoplay id=bg_video %}
{% endif %}
{% endblock %}
{% block extra_js %}
{% comment %} <script type="text/javascript" src="{% static 'js/home_page.js' %}"></script> {% endcomment %}
{% endblock %}
